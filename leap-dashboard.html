// Add this to the top of your script section:
const LEAP_SERVICE_URL = 'https://uat-qportal.information.qld.gov.au/arcgis/rest/services/sirrte_idi_LEAP_ClaimParcels_vegtest/MapServer/1/query?where=1=1&outFields=*&f=json';

function loadDirectLEAPData() {
    addDebugMessage('Attempting direct connection to LEAP service...');
    updateStatusText('Connecting directly to Queensland Government LEAP database...');
    
    fetch(LEAP_SERVICE_URL)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: Service requires authentication`);
            }
            return response.json();
        })
        .then(data => {
            if (data.features && data.features.length > 0) {
                addDebugMessage('SUCCESS: Direct connection loaded ' + data.features.length + ' LEAP records');
                processLEAPData(data.features);
                updateStatusText('Connected directly to LEAP database âœ“');
            } else {
                throw new Error('No features returned from LEAP service');
            }
        })
        .catch(error => {
            addDebugMessage('Direct connection failed: ' + error.message);
            addDebugMessage('This is normal - Queensland Government data requires authentication');
            updateStatusText('Service requires authentication - showing how it would work');
            showClaimNSimulation();
        });
}

function showClaimNSimulation() {
    addDebugMessage('Showing simulation with claim_n field structure...');
    
    // Simulate data with your claim_n field
    const simulatedData = [
        {attributes: {claim_n: 'Barunggam People', OBJECTID: 1, veg_assessment: 'Complete'}},
        {attributes: {claim_n: 'Bigambul People', OBJECTID: 2, env_assessment: 'Pending'}},
        {attributes: {claim_n: 'Gomeroi People', OBJECTID: 3, land_use: 'Active'}},
        {attributes: {claim_n: 'Jagera People', OBJECTID: 4, veg_assessment: 'Complete'}},
        {attributes: {claim_n: 'Yuggera People', OBJECTID: 5, env_assessment: 'Active'}}
    ];
    
    addDebugMessage('Simulated data shows how dashboard would display your real claim_n data');
    processLEAPData(simulatedData);
}
